<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Bank Details</title>
<style>
body{margin:0;font-family:Arial;background:#001f3f;color:white;}
.header{padding:20px;background:#003366;font-weight:bold;}
.container{padding:20px;}
input{
  width:100%;
  padding:12px;
  margin-bottom:15px;
  border:none;
  border-radius:8px;
  background:#0a2540;
  color:white;
}
button{
  width:100%;
  padding:12px;
  background:#00c853;
  border:none;
  border-radius:8px;
  color:white;
  font-weight:bold;
  cursor:pointer;
}
</style>
</head>
<body>

<div class="header">BANK DETAILS</div>
<div class="container">
  <input id="accountName" placeholder="Account Name">
  <input id="accountNumber" placeholder="Account Number">
  <input id="bankName" placeholder="Bank Name">
  <input id="branchCode" placeholder="Branch Code">
  <button id="saveBtn">SAVE</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getAuth,onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
import { getDatabase,ref,get,update } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

const firebaseConfig={
  apiKey:"AIzaSyBqJTLjxhZBCsvjrTH_cG0fkXlElG6BqTg",
  authDomain:"tose-ccf8f.firebaseapp.com",
  databaseURL:"https://tose-ccf8f-default-rtdb.europe-west1.firebasedatabase.app",
  projectId:"tose-ccf8f"
};

const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const db=getDatabase(app);

onAuthStateChanged(auth, async user=>{
 if(!user){window.location.href="index.html";return;}

 const snap=await get(ref(db,"users/"+user.uid+"/bank"));
 if(snap.exists()){
   const b=snap.val();
   accountName.value=b.accountName||"";
   accountNumber.value=b.accountNumber||"";
   bankName.value=b.bankName||"";
   branchCode.value=b.branchCode||"";
 }

 saveBtn.onclick=async()=>{
   await update(ref(db,"users/"+user.uid+"/bank"),{
     accountName:accountName.value,
     accountNumber:accountNumber.value,
     bankName:bankName.value,
     branchCode:branchCode.value,
     updatedAt:Date.now()
   });
   alert("Bank details saved");
 }
});
</script>

</body>
</html>
